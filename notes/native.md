TGVE as Native Desktop App
================

This document shows how TGVE can be built and run using
[Tauri](https://tauri.studio/en/docs/getting-started/intro) (using Rust
and WebViews) to turbo charge its performance outside browsers. In our
tests, on a browser on the same machine we could load around 1m points.
Using a Tauri built app, we were able to load 3.5 crash data (long/lat
pairs) on the Tauri build OSX app on a MBP 16GB i7 machine. An advantage
of TGVE being a [CRA](https://create-react-app.dev) app is that tools
like Tauri can build it.

Let us clone the template
[repository](https://github.com/layik/eatlas-template) which runs the
latest `eAtlas` package in [CRA](https://create-react-app.dev) app, then
install dependenices and build it like this:

``` sh
# clone the template repository app
git clone https://github.com/layik/eatlas-template
cd eatlas-template
yarn install
```

    ## Cloning into 'eatlas-template'...
    ## yarn install v1.22.10
    ....
    ## [4/4] Building fresh packages...
    ## Done in 22.34s.

Before Tauri can bundle the application, we must build it and that is
easy in a CRA app:

``` sh
yarn run build
```

    ## yarn run v1.22.10
    ## $ react-scripts --max_old_space_size=4096 build
    ....
    ## 
    ## Done in 175.58s.

We now assume that you have followed the Tauri [documentations]() to set
up the requirements, including any platform specific (such as OSX)
requirements and you are ready to add Tauri npm package:

``` sh
yarn add tauri
```

    ## yarn add v1.22.10
    ## warning package-lock.json found. Your project contains lock files generated by tools other than Yarn. It is advised not to mix package managers in order to avoid resolution inconsistencies caused by unsynchronized lock files. To clear this warning, remove package-lock.json.
    ....
    ## └─ tauri@0.14.1
    ## Done in 8.51s.

If we have all the requirements for Tauri, we can now run the
interactive commands below to setup the build. The only thing to notice
is that by default Tauri expects the build directory to be `../dist` of
the application. CRA though builds to `../build`. Tauri does [not
allow](https://tauri.studio/en/docs/api/cli) `--yes` to all the
questions, otherwise we could go full reproducible:

``` sh
./node_modules/tauri/tauri.js init
# check build folder in 
./node_modules/tauri/tauri.js build
```

We should then be instructed, in our case on an OSX machine, to look for
the `dmg` in a path like
`src-tauri/target/release/bundle/dmg/tgve*.dmg`. This is an executable
and we should be able to see something like following image. The
screenshot shows the default `eatlas-tempate` UK (London area)
casualtites.csv dataset.

<img width="100%" alt="TGVE Native App Grid" src="https://user-images.githubusercontent.com/408568/119277580-71d5b500-bc18-11eb-8926-40114f899b97.png">

<img width="100%" alt="TGVE Native App heatmap" src="https://user-images.githubusercontent.com/408568/119277557-55d21380-bc18-11eb-93c1-11c2d5518cf0.png">

Note: this document is generated with
[Rmarkdown](https://bookdown.org/yihui/rmarkdown-cookbook/) which means
all results from code chunks are generated using real command runs on:

``` r
.Platform
```

    ## $OS.type
    ## [1] "unix"
    ## 
    ## $file.sep
    ## [1] "/"
    ## 
    ....
    ## 
    ## $path.sep
    ## [1] ":"
    ## 
    ## $r_arch
    ## [1] ""
